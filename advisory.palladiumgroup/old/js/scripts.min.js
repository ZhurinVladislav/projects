/*!

© kovrigin
Все права разрешены
красивый дизайн должен иметь красивый код®

https://github.com/htmlpluscss/

*/
window.addEventListener("load",()=>{localStorage.setItem("fastLoadScript",!0),document.documentElement.style.setProperty("--transitionDefault",".3s")}),window.cssAnimation=(e=>{let t,n,o=document.createElement("cssanimation");switch(e){case"animation":t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};break;case"transition":t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}}for(n in t)if(void 0!==o.style[n])return t[n]}),window.isInViewport=(e=>{const t=e.getBoundingClientRect();return t.top>=0&&t.bottom<=window.innerHeight}),(e=>{e.length&&[...e].forEach(e=>{let t=!1,n=null;const o=e.querySelectorAll(".accordion__item");[...o].forEach(e=>{const a=e.querySelector(".accordion__btn"),l=e.querySelector(".accordion__head"),r=e.querySelector(".accordion__body"),c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS(null,"viewBox","0 0 24 24"),c.setAttributeNS(null,"width",24),c.setAttributeNS(null,"height",24),c.innerHTML='<line x1="19" x2="19" y1="7" y2="17"/><line x1="14" x2="24" y1="12" y2="12"/>',l.append(c),a.addEventListener("click",()=>{t=!0,e===n?(e.classList.remove("is-open"),n=null):(n=e,[...o].forEach(t=>t.classList.toggle("is-open",t===e)))}),r.addEventListener(window.cssAnimation("transition"),()=>{t&&n&&!window.isInViewport(l)&&l.scrollIntoView({behavior:"smooth"}),t=!1})})})})(document.querySelectorAll(".accordion")),(e=>{const t="6LdjubYiAAAAAJCJFaBWu5DDvJWUxBrApeqJF_WC",n=()=>{[...e].forEach(e=>{e.removeEventListener("input",n)});const o=document.createElement("script");o.src="https://www.google.com/recaptcha/api.js?render="+t,document.head.appendChild(o)},o=new URLSearchParams(location.search);[...e].forEach(e=>{e.elements.url&&(e.elements.url.value=location.search),e.addEventListener("input",n),e.addEventListener("change",()=>{e.classList.toggle("not-rule",e.querySelectorAll(".checkbox__input").length!==e.querySelectorAll(".checkbox__input:checked").length)}),e.addEventListener("submit",n=>{n.preventDefault(),"undefined"==typeof grecaptcha?alert("Error! Google reCaptcha"):grecaptcha.ready(()=>{grecaptcha.execute(t).then(t=>{let n=null;const a=new FormData(e),l=e.querySelector(".form__submit");a.append("g_recaptcha_response",t),o.forEach((e,t)=>{t.includes("utm")&&a.append(t,e),t.includes("goal")&&(a.append(t,e),n=e)}),a.append("place","advisorymain"),l.disabled=!0,fetch(e.getAttribute("action"),{method:"POST",body:a}).then(e=>e.json()).then(t=>{if(console.log(t),ym(91004279,"reachGoal","lead"),n&&ym(91004279,"reachGoal",n),l.disabled=!1,e.elements.redirect)return void location.assign(e.elements.redirect.value);if(e.classList.contains("contact__form"))return void e.querySelector(".contact__form-done").classList.remove("hide");document.querySelector(".modal-done__title").innerHTML=t.title,document.querySelector(".modal-done__message").innerHTML=t.message,document.querySelectorAll(".modal-done__ico svg")[0].classList.toggle("hide","ok"!==t.status),document.querySelectorAll(".modal-done__ico svg")[1].classList.toggle("hide","ok"===t.status);const o=new CustomEvent("modalShow",{detail:{selector:"done"}});modal.dispatchEvent(o),e.reset()})})})})})})(document.querySelectorAll(".form")),[{selector:"#opencomp_btn",event:"click",yandex:{target:"opencomp"}},{selector:"#consult_btn",event:"click",yandex:{target:"consult"}},{selector:"#tg_ofzay_btn",event:"click",yandex:{target:"tg_ofzay"}},{selector:"#freezone_btn",event:"click",yandex:{target:"freezone"}},{selector:"#mainland_btn",event:"click",yandex:{target:"mainland"}},{selector:"#anketa_btn",event:"click",yandex:{target:"anketa"}},{selector:"#tg_head_btn",event:"click",yandex:{target:"tg_head"}},{selector:"#wa_head_btn",event:"click",yandex:{target:"wa_head"}},{selector:"#tel_head_btn_lg",event:"click",yandex:{target:"tel_head"}},{selector:"#tel_head_btn_sm",event:"click",yandex:{target:"tel_head"}},{selector:"#wa_foot_btn",event:"click",yandex:{target:"wa_foot"}},{selector:"#tg_foot_btn",event:"click",yandex:{target:"tg_foot"}},{selector:"#tel_foot_btn",event:"click",yandex:{target:"tel_foot"}}].forEach(e=>{e.page&&e.page!==location.pathname||e.skipPages&&-1!==e.skipPages.indexOf(location.pathname)||[...document.querySelectorAll(e.selector)].forEach(t=>{t.addEventListener(e.event,()=>{console.log(e.yandex.target),e.yandex&&window.ym&&ym(91004279,"reachGoal",e.yandex.target)})})}),(e=>{if(!e.length)return;const t=document.createElement("script");t.src="/js/inputmask.min.js",t.onload=(()=>{[...e].forEach(e=>{let t;e.classList.contains("inputmask--phone")&&(t=new Inputmask({mask:e.getAttribute("data-mask"),placeholder:"0"})),t.mask(e)})}),setTimeout(()=>document.head.appendChild(t),localStorage.getItem("fastLoadScript")?0:1e4)})(document.querySelectorAll(".inputmask")),(e=>{if(!e)return;const t=e.querySelectorAll(".modal__item"),n=(document.querySelectorAll("[data-modal]"),document.querySelector(".wrapper")),o=document.querySelector("#modal-form"),a=document.querySelector("#modal-title"),l=a.innerHTML;let r=null,c=window.pageYOffset;e.addEventListener("hide",()=>{document.body.classList.remove("modal-show"),n.style.top=0,window.scrollTo(0,c),r=!1,window.requestAnimationFrame(()=>document.documentElement.classList.remove("scroll-behavior-off"),500),document.querySelector("#modal-video").innerHTML=""}),e.addEventListener("keyup",t=>{"Escape"===t.key&&e.dispatchEvent(new Event("hide"))});const i=(i,s)=>{r||(c=window.pageYOffset),s?(a.textContent=s,o.elements.subject.value=s.trim()):(a.innerHTML=l,o.elements.subject.value=a.textContent.trim()),r=e.querySelector(".modal__item--"+i),[...t].forEach(e=>e.classList.toggle("visuallyhidden",e!==r)),document.documentElement.classList.add("scroll-behavior-off"),window.requestAnimationFrame(()=>{n.style.top=-c+"px",document.body.classList.add("modal-show"),window.scrollTo(0,0),r.focus()})};e.addEventListener("click",t=>{(t.target.classList.contains("modal")||t.target.closest(".modal__close"))&&e.dispatchEvent(new Event("hide"))}),document.addEventListener("click",e=>{let t=e.target;for(;t!==document&&null!==t;)t.hasAttribute("data-modal")&&i(t.getAttribute("data-modal"),t.getAttribute("data-title")),t=t.parentNode}),e.addEventListener("modalShow",e=>i(e.detail.selector))})(document.querySelector(".modal")),(e=>{0!==e.length&&([...e].forEach(e=>{const t=e.querySelector(".phone-country__mask"),n=e.querySelector(".phone-country__code"),o=e.querySelector(".phone-country__toggle-flag");[...e.querySelectorAll(".phone-country__item")].forEach(e=>{e.addEventListener("click",()=>{let a,l=e.getAttribute("data-mask");l=(l=(l=l.replace(/\\9/g,"$")).replace(/9/g,"0")).replace(/\$/g,"9"),t.setAttribute("placeholder",l),t.value="",Inputmask(e.getAttribute("data-mask")).mask(t),(a=new Inputmask({mask:e.getAttribute("data-mask"),placeholder:"0"})).mask(t),t.focus(),n.value=e.getAttribute("data-code"),o.innerHTML=e.querySelector(".phone-country__item-flag").innerHTML})})}),window.addEventListener("click",t=>{const n=t.target.closest(".phone-country__toggle")?t.target.closest(".phone-country"):null;[...e].forEach(e=>{e.classList.toggle("is-open",e===n&&!1===n.classList.contains("is-open"))})}))})(document.querySelectorAll(".phone-country")),(e=>{if(e.length){const t=new URLSearchParams(location.search).get("start");null!==t&&[...e].forEach(e=>{!1===e.href.includes("start")&&(e.href=e.href+"?start="+t)})}})(document.querySelectorAll(".set-url-param")),(e=>{if(e.length){const t=document.querySelector("#modal-video");[...e].forEach(e=>{const n=e.getAttribute("data-youtube");e.addEventListener("click",e=>{e.preventDefault();const o=document.createElement("iframe");o.setAttribute("allowfullscreen",""),o.setAttribute("allow","autoplay"),o.setAttribute("src","https://www.youtube.com/embed/"+n+"?rel=0&showinfo=0&autoplay=1"),t.appendChild(o);const a=new CustomEvent("modalShow",{detail:{selector:"video"}});window.modal.dispatchEvent(a)})})}})(document.querySelectorAll("[data-youtube]"));