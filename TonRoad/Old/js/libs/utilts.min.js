const utilts = () => {
  /* Проверка поддержки webp, добавление класса webp или no-webp для HTML */
  const webp = callback => {
    const webP = new Image();

    webP.onload = webP.onerror = () => callback(webP.height == 2);

    webP.src = 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';
  };

  webp(support => {
    const className = support === true ? 'webp' : 'no-webp';

    document.documentElement.classList.add(className);
  });

  /* Убираем фокус после нажатия на кнопку или ссылку */
  const removeFocus = () => {
    const arrBtn = document.querySelectorAll('button');
    const arrLink = document.querySelectorAll('a');
    const arrElements = [...arrBtn, ...arrLink];

    arrElements.forEach(ev => {
      ev.addEventListener('mousedown', el => el.preventDefault());
      ev.addEventListener('mouseup', el => el.preventDefault());
    });
  };

  removeFocus();

  /* Нормализуем ссылки на номер телефона. */
  const normalizePhoneLink = () => {
    const arrLinks = document.querySelectorAll('a[href^="tel:"]');

    if (arrLinks.length === 0) return;

    arrLinks.forEach(el => {
      const normalizeHref = el.href.replace(/[^+\d]/g, '');
      el.href = `tel:${normalizeHref}`;
    });
  };

  normalizePhoneLink();
};

utilts();
